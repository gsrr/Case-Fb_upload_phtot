<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
	<title>Three elements with "float: left" applied</title>
	<style type="text/css" media="screen">
		body
		{
			margin: 20px;
			padding: 0;
			font: normal 85% arial, helvetica, sans-serif;
			color: #000;
			background-color: #fff;
		}
		
		.containingbox
		{
			width: 400px;
			height: 400px;
			border: 1px solid #000;
		}
		
		.imgsize
		{
			height: 300px ;
            width: 300px;
		}
        table, th, td {
           border: 1px solid black;
        }
        p{
            width:300px;
        }
    </style>
    <script src="../js/callPython.js"></script>
    <script>
        function init_image()
        {
            var data = {
                "prog": "fileManager",
                "op": "listDir",
                "path" : "fb_upload\\image" 
            };
            console.log(data);
            callPython(data, function(ret){
                var files = jQuery.parseJSON(ret['data']);
                console.log(files);
                var img_dir = $("#img_path").val();
                for(var i = 0 ; i < files.length ; i += 2)
                {
                     $("#image_table").find('tbody').append($('<tr>').attr('id', 'img_' + i));
                     $("#img_" + i).append($('<td>').append($('<img>').addClass("imgsize").attr('src', files[i])));
                     $("#img_" + i).append($('<td>').append($('<img>').addClass("imgsize").attr('src', files[i + 1])));
                     $("#img_" + i).append($('<td>').append($("<p>").attr('id', 'p_' + i)));
                     $("#img_" + i).append($('<td>').append($("<button>").html("upload").attr('id', 'btn_' + i)));
                    
                }
                
            });
        }
        function readCsvFile(evt) 
        {
            //Retrieve the first (and only!) File from the FileList object
            var f = evt.target.files[0]; 
            if (f) 
            {
              var r = new FileReader();
              r.onload = function(e) { 
                var contents = e.target.result.split("\n");
                var heads = ["書名", "價格", "代碼", "備註"];
                var cnt = 0;
                for(var i = 0 ; i < contents.length ; i++)
                {
                    var info_arr = contents[i].split(",");
                    for (var j = 0 ; j < info_arr.length ; j++)
                    {
                        $("#p_" + cnt).append($("<span>").html(heads[j] + ":" + info_arr[j] + "<br/>"));
                    }
                    
                    cnt += 2;
                }
              }
              r.readAsText(f);
            } 
            else 
            { 
              alert("Failed to load file");
            }
        }
        function importCSV()
        {
            $( "#csvfile" ).trigger( "click" );
        }
        function createAlbum()
        {
            var data = {
                "prog": "fbOperation",
                "op": "create_album",
                "token" : $("#token").val(),
                "id_group" : $("#id_group").val(),
                "name_album" : $("#name_album").val(),
                "msg_album" : $("#msg_album").val()
                
            };
            console.log(data);
             callPython(data, function(ret){
                console.log(ret);
             });
        }
        $("document").ready(function(){
            init_image();
            $("#import_csv").click(importCSV);
            document.getElementById('csvfile').addEventListener('change', readCsvFile, false);
            $("#create_album").click(createAlbum);
        });
    </script>
</head>
<body>
<table>
     <tr>
        <td><a href="https://developers.facebook.com/tools/explorer/145634995501895/"  target="_blank">access_token</a></td>
        <td><input id="token" type="text" size="80"/></td>
    </tr>
    <tr>
        <td>Group url</td>
        <td><input id="id_group" type="text" size="80"/></td>
    </tr>
    <tr>
        <td>Name of album</td>
        <td><input id="name_album" type="text" size="30"/></td>
    </tr>
    <tr>
        <td>message of album</td>
        <td><input id="msg_album" type="text" size="30"/></td>
    </tr>
    <tr>
        <td colspan="2" align="left">
            <button id="create_album">Create Album</button>
            <button id="import_csv">import csv(excel) file</button>
            <input id="csvfile" type="file" style="display:none"/>
            <button id="upload_all">upload all photos</button><br/>
        </td>
    </tr>
</table>

<table id="image_table" width="50%">
<tbody>
</tbody>
    
</table>
</div>
</body>
</html>